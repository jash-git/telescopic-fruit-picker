(self.miniJsonp=self.miniJsonp||[]).push([[8592],{25061:function(e,t,r){var o,s,a,n,c,i,u,E,l,S,d;e.exports=(o=r(34857),s=r(20573),a=r(29494),n=r(96961),c=r(6678),i=r(82677),u=r(38104),E=r(58518),l=r(44900),S=r(67429),d=r(36808),(()=>{"use strict";var e={701:(e,t,r)=>{r.d(t,{t:()=>a});var o=r(661),s=r.n(o),a=s().t.bind(s())},661:e=>{e.exports=E},598:e=>{e.exports=d},383:e=>{e.exports=i},252:e=>{e.exports=c},944:e=>{e.exports=o},975:e=>{e.exports=s},783:e=>{e.exports=u},644:e=>{e.exports=n},855:e=>{e.exports=a},672:e=>{e.exports=l},459:e=>{e.exports=S}},t={};function r(o){var s=t[o];if(void 0!==s)return s.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var _={};return(()=>{r.r(_),r.d(_,{addNeedCaptchaRequest:()=>aa,agentConversationEntitiesSelector:()=>i,allMessageShortcutGroupsSelector:()=>Io,authorizedShopsCountSelector:()=>Pe,autoTranslation:()=>Qo,batchRemoveDraftHandler:()=>ke,batchUpdateRecord:()=>w,blockUserRequested:()=>Ur,captchaSignatureSelector:()=>se,captchaVerifyReducer:()=>la,captchaVisibleSelector:()=>oe,checkUserPermissionSaga:()=>sr,checkUserPermissionSucceeded:()=>$t,checkUserVerifyStatus:()=>ar,checkUserVerifyStatusRequested:()=>tr,checkUserVerifyStatusSucceed:()=>rr,clearNeedCaptchaRequest:()=>ca,clearReportRequested:()=>Ks,contactsEntitiesSelector:()=>h,conversationEntitiesSelector:()=>c,conversationsLengthLevelSelector:()=>D,copySucceedFeedback:()=>_o,curTabFocusedSelector:()=>De,currentAllMessageShortcutsSelector:()=>jo,currentGroupIdSelector:()=>bo,currentGroupTypeSelector:()=>Ro,currentMessageShortcutGroupsSelector:()=>No,currentUserDistributionStatusSelector:()=>Oe,currentUserIdSelector:()=>W,currentUserIsSellerSelector:()=>be,currentUserRoleSelector:()=>Te,currentUserSelector:()=>ie,currentUserShopIdSelector:()=>_e,currentUserShopSelector:()=>pe,defaultPagination:()=>no,deleteCaptchaRequest:()=>na,deleteConfigDurationSelector:()=>J,deleteConfigSelector:()=>te,deleteConversationSucceedHandler:()=>je,deleteRecord:()=>N,displayCBCBannerSelector:()=>Bo,distributionAccountStatusSelector:()=>Wo,draftHashSelector:()=>Cs,entitiesSelector:()=>a,entityReducer:()=>k,fetchSettings:()=>$o,fetchSettingsStatusSelector:()=>Rs,fetchShopAuth:()=>to,fetchShopAuthRequested:()=>Mr,fetchShopDetailInfo:()=>Kr,fetchShopSettings:()=>Ls,fetchShopTranslationSettings:()=>ms,fetchShopsByIds:()=>eo,fetchShopsRequested:()=>Fr,fetchUserOrderDetailRequested:()=>ft,fetchUserOrderDetailSucceeded:()=>At,fetchedShopIdsSelector:()=>Lr,forceLogoutRequested:()=>Qt,forwardGroupMembersSelector:()=>y,forwardGroupsEntitiesSelector:()=>A,getConversationLastMessage:()=>$e,getDraft:()=>Us,getGuide:()=>it,getGuideFailed:()=>at,getGuideRequested:()=>ot,getGuideSucceeded:()=>st,getShopUnreadCountByIds:()=>$r,getTimestamp:()=>Ye,getToastInformation:()=>So,handle401ErrorRequested:()=>Ts,handleLoginSucceededLogic:()=>Kt,handleMessageSubscribe:()=>Qe,hasDeletePermissionSelector:()=>X,hasFetchedUnreadSelector:()=>Ue,hasReplyPermissionSelector:()=>z,hasVerifyPhoneNumberNormalSellerSelector:()=>Ie,hasVerifyPhoneNumberSelector:()=>me,hasVerifyPhoneNumberSubaccountSelector:()=>ve,hasVideoPermissionSelector:()=>Y,hideFeedbackSelector:()=>ee,isCBSellerSelector:()=>le,isMainPageSelector:()=>he,isSubAccountSelector:()=>Ee,legacyMessageShortcutsCountSelector:()=>xo,loadingSelector:()=>x,localeSelector:()=>ue,login:()=>Yt,loginRequested:()=>Gt,loginSucceeded:()=>kt,loginSuccessSelector:()=>ge,logout:()=>Rr,logoutHandler:()=>Pr,logoutRequested:()=>Mt,logoutSucceeded:()=>Vt,messageEntitiesSelector:()=>u,messageShortcutGroupEntitiesSelector:()=>p,messageShortcutGroupHttpStatusSelector:()=>Po,messageShortcutGroupSelector:()=>Uo,messageShortcutsSelector:()=>Fo,messageShortcutsStatusSelector:()=>qo,messagesLengthLevelSelector:()=>f,networkStatusSelector:()=>K,newMessageFlagSelector:()=>ne,newbieSelector:()=>B,notificationTypes:()=>et,offerSelector:()=>As,offersSelector:()=>Ds,openMallUrl:()=>ds,openMallUrlSaga:()=>ps,orderEntitiesSelector:()=>l,personalMessageShortcutGroupsSelector:()=>vo,personalMessageShortcutsSelector:()=>wo,productEntitiesSelector:()=>S,productsSelector:()=>xs,pureActionHandler:()=>We,pureMergeActionHandler:()=>Be,rateCardEntitiesSelector:()=>T,reduxReset:()=>ys,relatedOfferIdsSelector:()=>fs,removeSingleDraftHandler:()=>Ge,reportArraySelector:()=>Ws,reportMessageApiTimer:()=>ze,reportReducer:()=>ta,reportRequested:()=>Bs,reportUserRequested:()=>br,resendMessagePayloadSelector:()=>ae,resendNeedCaptchaRequest:()=>ia,saveDraftHandler:()=>Me,searchShopsRequested:()=>xr,setChatListWidth:()=>gr,setTextBoxHeight:()=>yr,setToastInformation:()=>po,setToastInformationSaga:()=>Oo,settingsFetchStatusSelector:()=>Vo,settingsNeedForceUpdateSelectors:()=>ko,settingsReducer:()=>Ss,settingsSelector:()=>Go,settingsStatusSelector:()=>Mo,shopReducer:()=>uo,shopSelector:()=>jr,shopStatisticsMapSelector:()=>Se,shopStatisticsSelector:()=>de,shopTranslationSettingsSelector:()=>Ps,shopsEntitiesSelector:()=>O,shopsUnreadConversationCountSelector:()=>M,showAutoHangupModalSelector:()=>Re,showChatWindowSelector:()=>ye,showConversationDetailSelector:()=>Ae,showCrrDueSelector:()=>$,showEntrySelector:()=>Ce,showShop:()=>Yr,showUser:()=>ir,showUserRequested:()=>cr,sortConversations:()=>Ke,sortedAllMessageShortcutsSelector:()=>Lo,stickerEntitiesSelector:()=>E,subaccountHasUnrepliedPermissionSelector:()=>re,takeEveryWithCancel:()=>_a,teamMessageShortcutGroupsSelector:()=>mo,teamMessageShortcutsSelector:()=>Ho,textBoxHeightSelector:()=>fe,timerHandler:()=>Xs,toastReducer:()=>Co,toastSelector:()=>Eo,totalUnreadConversationsCountSelector:()=>V,translatePreferenceReducer:()=>Gs,unreadCountActions:()=>Q,updateCaptchaSignature:()=>Or,updateCaptchaSignatureSucceeded:()=>hr,updateCaptchaVisible:()=>Tr,updateChatEntryStatus:()=>Pt,updateChatWindowStatus:()=>gt,updateConversationDetailStatus:()=>Ct,updateConversationListsHash:()=>Os,updateCurTabFocused:()=>lr,updateCurTabFocusedSaga:()=>dr,updateCurTabFocusedSucceeded:()=>Sr,updateDelPermission:()=>er,updateEntities:()=>v,updateFetchStatus:()=>ws,updateFetchedShopIds:()=>Vr,updateGuide:()=>dt,updateGuideRequested:()=>lt,updateGuideSucceeded:()=>St,updateHasFetchedUnread:()=>Rt,updateIsMainPage:()=>Er,updateLoginSuccessStatus:()=>Ut,updateNetworkStatus:()=>Dt,updateOrReplaceAction:()=>Qs,updateRecord:()=>m,updateSettingPreferenceStatus:()=>Hs,updateSettingStatus:()=>zo,updateSettings:()=>as,updateSettingsRequested:()=>Jo,updateSettingsRequestedByType:()=>Xo,updateSettingsSucceeded:()=>Zo,updateShopFilter:()=>Qr,updateShopTranslationSettings:()=>Ns,updateShopTranslationSettingsRecord:()=>js,updateShowAutoHangupModal:()=>yt,updateStatusSelector:()=>bs,updateUserRequested:()=>ht,userEntitiesSelector:()=>n,userReducer:()=>Hr,userSelector:()=>ce,verifyRequestsSelector:()=>da,visitShopSellerCenterRequested:()=>qr,voucherEntitiesSelector:()=>d,waitingTimeFilterSelector:()=>Z,watchGuides:()=>ut,watchHandleUrlSagas:()=>hs,watchLogin:()=>zt,watchReportSagas:()=>ea,watchSettingsSagas:()=>ls,watchShopSagas:()=>co,watchShow:()=>ur,watchTab:()=>_r,watchToastSagas:()=>go,watchTranslationSagas:()=>ks,watchTranslationSettings:()=>Fs,watchUpdate:()=>vt,watchUpdateGuides:()=>_t,watchUserSagas:()=>Nr,watchVerifySagas:()=>Sa});var e=r(944),t=r(975),o=r(855),s=e=>e<=100?1:e<=500?2:e<=1e3?3:4,a=e=>e.entityReducer,n=(0,t.createSelector)(a,(e=>e.users)),c=(0,t.createSelector)(a,(e=>e.conversations)),i=(0,t.createSelector)(a,(e=>e.agentConversations)),u=(0,t.createSelector)(a,(e=>(e=>(0,o.checkEmptyObject)(e)?{}:e)(e.messages))),E=(0,t.createSelector)(a,(e=>e.stickers)),l=(0,t.createSelector)(a,(e=>e.orders)),S=(0,t.createSelector)(a,(e=>e.products)),d=(0,t.createSelector)(a,(e=>e.vouchers)),p=(0,t.createSelector)(a,(e=>e.messageShortcutsGroups)),T=(0,t.createSelector)(a,(e=>e.rateCards)),O=(0,t.createSelector)(a,(e=>e.shops)),h=(0,t.createSelector)(a,(e=>e.contacts)),D=(0,t.createSelector)(c,i,((e,t)=>{var r=Object.keys(e).length+Object.keys(t).length;return s(r)})),f=(0,t.createSelector)(u,(e=>s(Object.keys(e).length))),A=(0,t.createSelector)(a,(e=>e.groups)),y=(0,t.createSelector)(a,(e=>e.groupMembers));function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var C,U=r(644);function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.UPDATE_ENTITIES="UPDATE_ENTITIES",e.UPDATE_RECORD="UPDATE_RECORD",e.DELETE_RECORD="DELETE_RECORD",e.BATCH_UPDATE_RECORD="BATCH_UPDATE_RECORD"}(C||(C={}));const b={[C.UPDATE_ENTITIES]:(e,{payload:{entities:t}})=>Object.entries(t).reduce(((e,[t,r])=>"persist"!==t?("shops"===t&&U.shopService.updateShopMap(r),R(R({},e),{},{[t]:R(R({},e[t]),r)})):R(R({},e),{},{[t]:r})),e)};var I=r(252),{updateEntities:v,updateRecord:m,deleteRecord:N,batchUpdateRecord:w}=(0,I.createActions)({[C.UPDATE_ENTITIES]:({entities:e})=>({entities:e}),[C.UPDATE_RECORD]:({name:e,id:t,record:r})=>({name:e,id:t,record:r}),[C.DELETE_RECORD]:({name:e,id:t})=>({name:e,id:t}),[C.BATCH_UPDATE_RECORD]:({name:e,records:t,checkProp:r})=>({name:e,records:t,checkProp:r})});function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const L={[C.UPDATE_RECORD]:(e,{payload:{name:t,id:r,record:o}})=>j(j({},e),{},{[t]:j(j({},e[t]),{},{[r]:j(j({},e[t][r]),o)})}),[C.DELETE_RECORD]:(e,{payload:{name:t,id:r}})=>{var o=e[t];return delete o[r],j(j({},e),{},{[t]:o})},[C.BATCH_UPDATE_RECORD]:(e,{payload:{name:t,records:r,checkProp:o}})=>{var s=j({},e[t]);return Object.keys(r).forEach((e=>{(!o||o&&r[e][o]>s[e][o])&&(s[e]=j(j({},s[e]),r[e]))})),j(j({},e),{},{[t]:s})}};function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var k=(0,I.handleActions)(G(G({},b),L),{users:{},messages:{},conversations:{},agentConversations:{},stickers:{},orders:{},offers:{},products:{},shops:{},rateCards:{},persist:null,vouchers:{},messageShortcuts:{}}),M=e=>{var t;return(null==e||null===(t=e.socketReducer)||void 0===t?void 0:t.shopsUnreadConversationCount)||0},V=e=>{var t;return(null==e||null===(t=e.socketReducer)||void 0===t?void 0:t.totalUnreadConversationsCount)||0},Q={MARK_AS_READ:"markAsRead",MARK_AS_UNREAD:"markASUnread",CLOSE_CONVERSATION:"closeConversation",DELETE_CONVERSATION:"deleteConversation",FORWARD_CONVERSATION:"forwardConversation",RECEIVE_UNREADABLE_MESSAGE:"receiveUnreadableMessage",REFRESH_TOTAL_UNREAD_CONVERSATION_COUNT:"refreshTotalUnreadConversationCount",REFRESH_SHOPS_UNREAD_CONVERSATIONS_COUNT:"refreshShopsUnreadConversationsCount",REFRESH_SINGLE_SHOP_UNREAD_CONVERSATION_COUNT:"refreshSingleShopUnreadConversationCount",UPDATE_CONVERSATION:"updateConversation",MESSAGE_QUEUE_UPDATE:"messageQueueUpdate",MASS_READ:"mass_read",MASS_UNREAD:"mass_unread",MASS_CLOSE:"mass_close",ACTIVE_CONVERSATION:"activeConversation",CLEAR_CONVERSATION_COUNT:"clearConversationCount"},q=r(383),x=e=>e.userReducer.loading,W=e=>e.userReducer.currentUserId,B=e=>e.userReducer.newbie,K=e=>e.userReducer.networkStatus,Y=e=>e.userReducer.hasVideoPermission,z=e=>e.userReducer.hasReplyPermission,X=e=>e.userReducer.hasDeletePermission,J=e=>e.userReducer.deleteConfigDuration,Z=e=>e.userReducer.waitingTimeFilter,$=e=>e.userReducer.showCrrDue,ee=e=>e.userReducer.hideFeedback,te=e=>{var{hasDeletePermission:t,deleteConfigVersion:r,deleteConfigDuration:o}=e.userReducer;return{hasDeletePermission:t,deleteConfigVersion:r,deleteConfigDuration:o}},re=e=>e.userReducer.subaccountHasUnrepliedPermission,oe=e=>e.userReducer.captchaVisible,se=e=>e.userReducer.captchaSignature,ae=e=>e.userReducer.resendMessagePayload,ne=e=>e.userReducer.newMessageFlag,ce=e=>(0,t.createSelector)(a,(t=>(0,q.denormalize)(e,U.userSchema,{users:t}))),ie=(0,t.createSelector)(n,W,((e,t)=>(0,q.denormalize)(t,U.userSchema,{users:e})||{})),ue=(0,t.createSelector)(ie,(e=>e&&e.locale)),Ee=(0,t.createSelector)(ie,(e=>!(0,o.checkEmptyObject)(e)&&e.type===o.AccountType.SUBACCOUNT)),le=(0,t.createSelector)(ie,(e=>!(0,o.checkEmptyObject)(e)&&e.is_cb)),Se=e=>e.userReducer.shopStatisticsMap,de=(e,r)=>(0,t.createSelector)(Se,(t=>t["".concat(e,"-").concat(r)]||{})),_e=(0,t.createSelector)(ie,Ee,((e={},t)=>t?void 0:e.shop_id)),pe=(0,t.createSelector)(ie,Ee,O,((e={},t,r)=>t?void 0:(0,q.denormalize)(e.shop_id,U.shopSchema,{shops:r})||{})),Te=(0,t.createSelector)(ie,((e={})=>e.role||"")),Oe=(0,t.createSelector)(ie,(e=>e&&e.distribution_status||"")),he=e=>e.userReducer.isMainPage,De=e=>e.userReducer.curTabFocused,fe=e=>e.userReducer.textBoxHeight,Ae=e=>e.userReducer.showConversationDetail,ye=e=>e.userReducer.showChatWindow,ge=e=>e.userReducer.loginSuccess,Ce=e=>e.userReducer.showEntry,Ue=e=>e.userReducer.hasFetchedUnread,Pe=(0,t.createSelector)(ie,((e={})=>e.authorizedShopsCount||0)),Re=e=>e.userReducer.showAutoHangupModal,be=(0,t.createSelector)(ie,Ee,((e={},t)=>!!t||e.is_seller)),Ie=e=>e.userReducer.hasVerifyPhoneNumber,ve=e=>e.userReducer.hasVerifyPhoneNumberMap,me=(0,t.createSelector)(Ee,Ie,ve,((e,t,r)=>e?r:t));function Ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var He=(e,t)=>{var r=new Set(t);return r.delete(e),Array.from(r)},je=(e,{payload:{conversationId:t}})=>{var r=we(we({},e.conversationIdsMap),{},{[t]:!1}),o=He(t,e.conversationIds),s=He(t,e.pinnedConversationIds),{currentConversationId:a}=e;return we(we({},e),{},{currentConversationId:a===t?null:a,conversationIds:o,pinnedConversationIds:s,conversationIdsMap:r})};function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ge=(e,{payload:{conversationId:t}})=>{var r=Fe({},e.draftHash);return delete r[t],Fe(Fe({},e),{},{draftHash:r})},ke=(e,{payload:{conversationIds:t=[]}})=>{var r=Fe({},e.draftHash);return t.forEach((e=>{delete r[e]})),Fe(Fe({},e),{},{draftHash:r})},Me=(e,{payload:{conversationId:t,draft:r}})=>{var o=Fe({},e.draftHash);return o[t]=r,Fe(Fe({},e),{},{draftHash:o})},Ve=r(783);function*Qe(t){var{payload:r,type:s}=t;yield(0,e.spawn)(ze,r.request_id),s===o.ConversationTypeEnum.Agent?yield(0,e.put)((0,Ve.receiveAgentMessageRequested)({message:r})):yield(0,e.put)((0,Ve.receiveMessageRequested)({message:r}))}function qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var We=()=>(e,{payload:t})=>xe(xe({},e),t),Be=e=>(t,{payload:r})=>xe(xe({},t),{},{[e]:xe(xe({},t[e]),r)}),Ke=e=>{e.sort(((e,t)=>parseInt(t.latest_message_id)-parseInt(e.latest_message_id)))},Ye=(e,t)=>{var{last_message_time_nano:r,next_timestamp_nano:o}=e;return t&&!o&&(o=t.next_message_time_nano),{nextTimestampNano:o,oldestTimestampNano:o,latestTimestampNano:r}};function*ze(e){var t=yield(0,o.getItem)(e);if(t){var r=+new Date-+t;(0,U.collectAsyncTask)(U.ReportPoint.MESSAGE_SOCKET,r),(0,o.removeItem)(e)}}var Xe,Je=r(701).t,{MSG_TYPE_TEXT:Ze}=o.MessageTypes,$e=(e,t,r)=>{var s=e.all||[],a=e.sending||[],n=e.failed||[],c=s.length,i=null;if(c){for(var u=0,E=null;u<c&&!E;){var l=e.all[u];(E=(0,q.denormalize)(l,U.messageSchema,{messages:r}))&&(E.type===o.MessageTypes.MSG_TYPE_SECURITY_TIPS||E.isFaking)&&(E=null),u++}E&&E.created_timestamp>Math.floor(t.last_message_time_nano/Math.pow(10,9))&&(i=(0,o.fillMessagePreview)(E))}if(!i){var{latest_message_id:S,latest_message_content:d,latest_message_type:_,last_message_option:p,latest_message_source:T,last_message_time_nano:O,latest_message_to_shop_id:h}=t;(i={id:S,content:d,type:_,message_option:p,source:T,to_shop_id:h}).created_at=new Date(O/1e6)+""}var{id:D,message_option:f}=i,A=a.includes(D)?o.MessageSendStatus.SENDING:n.includes(D)?o.MessageSendStatus.FAILED:i.send_status?o.MessageSendStatus.SUCCEED:null;return(0,o.hasTargetMessageOption)(f,o.MessageOption.MSG_OPT_CENSORED_BLACKLIST)&&(A=o.MessageSendStatus.FAILED,i.type=Ze,i.content={text:Je("common.blacklist.replaced_text")}),(0,o.hasTargetMessageOption)(f,o.MessageOption.MSG_OPT_CANCELORDER_WARNING_NOT_SEND)&&(A=o.MessageSendStatus.FAILED),i.send_status=A,i},et={MARK_AS_READ:"mark_as_read",MARK_AS_UNREAD:"mark_as_unread",DELETE_CONVERSATION:"delete_conversation",UPDATE_OFFER_STATUS:"update_offer_status",UPDATE_CONVERSATION:"update_conversation",UPDATE_USER_STATUS:"update_user_status",UPDATE_CONVERSATION_FLAG:"update_conversation_flag",FORCE_LOGOUT:"force_logout",UPDATE_RATING_CARD_STATUS:"update_rating_card_status",PULL_NOTIFICATION:"pull_notification",PIN_CONVERSATION:"pin_conversation",UNPIN_CONVERSATION:"unpin_conversation",MASS_READ:"mass_read",MASS_UNREAD:"mass_unread",MASS_PIN:"mass_pin",MASS_UNPIN:"mass_unpin",MASS_CLOSE:"mass_close",MASS_ACTIVATE:"mass_activate",VIDEO_UPLOAD:"video_upload",MARK_AS_REPLIED:"mark_as_replied",MARK_AS_UNREPLIED:"mark_as_unreplied",CHAT_DELETE_MSG:"chat_delete_msg",FAQ_SESSION_UPDATE:"faq_session_update",MUTE_CONVERSATION:"mute_conversation",UNMUTE_CONVERSATION:"unmute_conversation",CTT_UPDATE:"ctt_update",HAVE_UNRATED_CSAT:"have_unrated_csat"};function tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.BLOCK_USER_REQUESTED="BLOCK_USER_REQUESTED",e.CHECK_USER_PERMISSION_SUCCEEDED="CHECK_USER_PERMISSION_SUCCEEDED",e.CLOSE_HANGUP_TIPS_REQUESTED="CLOSE_HANGUP_TIPS_REQUESTED",e.GET_GUIDE_REQUESTED="GET_GUIDE_REQUESTED",e.GET_GUIDE_SUCCEEDED="GET_GUIDE_SUCCEEDED",e.GET_GUIDE_FAILED="GET_GUIDE_FAILED",e.SHOW_LOADING_SUCCEEDED="SHOW_LOADING_SUCCEEDED",e.SET_HAS_SESSION="SET_HAS_SESSION",e.SHOW_USER_REQUESTED="SHOW_USER_REQUESTED",e.FETCH_USER_ORDER_DETAIL_REQUESTED="FETCH_USER_ORDER_DETAIL_REQUESTED",e.FETCH_USER_ORDER_DETAIL_SUCCEEDED="FETCH_USER_ORDER_DETAIL_SUCCEEDED",e.FETCH_USER_PERFORMANCE_REQUESTED="FETCH_USER_PERFORMANCE_REQUESTED",e.FETCH_USER_PERFORMANCE_SUCCEED="FETCH_USER_PERFORMANCE_SUCCEED",e.UPDATE_USER_REQUESTED="UPDATE_USER_REQUESTED",e.UPDATE_NETWORK_STATUS="UPDATE_NETWORK_STATUS",e.UPDATE_CUR_TAB_FOCUSED="UPDATE_CUR_TAB_FOCUSED",e.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED="UPDATE_CUR_TAB_FOCUSED_SUCCEEDED",e.UPDATE_WORKSTATION_PANEL="UPDATE_WORKSTATION_PANEL",e.UPDATE_NEW_MESSAGE_FLAG="UPDATE_NEW_MESSAGE_FLAG",e.UPDATE_CHAT_WINDOW_STATUS="UPDATE_CHAT_WINDOW_STATUS",e.UPDATE_CONVERSATION_DETAIL_STATUS="UPDATE_CONVERSATION_DETAIL_STATUS",e.UPDATE_LOGIN_SUCCESS_STATUS="UPDATE_LOGIN_SUCCESS_STATUS",e.UPDATE_CHAT_ENTRY_STATUS="UPDATE_CHAT_ENTRY_STATUS",e.UPDATE_GUIDE_REQUESTED="UPDATE_GUIDE_REQUESTED",e.UPDATE_GUIDE_SUCCEEDED="UPDATE_GUIDE_SUCCEEDED",e.LOGIN_REQUESTED="LOGIN_REQUESTED",e.LOGIN_SUCCEEDED="LOGIN_SUCCEEDED",e.LOGOUT_REQUESTED="LOGOUT_REQUESTED",e.LOGOUT_SUCCEEDED="LOGOUT_SUCCEEDED",e.UPDATE_LOGIN_STATUS="UPDATE_LOGIN_STATUS",e.SHOW_TRANSLATION_GUIDE="SHOW_TRANSLATION_GUIDE",e.SHOW_REGION_FILTER_GUIDE="SHOW_REGION_FILTER_GUIDE",e.FORCE_LOGOUT_REQUESTED="FORCE_LOGOUT_REQUESTED",e.CONNECT_SOCKET="CONNECT_SOCKET",e.REPORT_ASYNC_TASK="REPORT_ASYNC_TASK",e.UPLOAD_FEEDBACK_VIDEO_REQUESTED="UPLOAD_FEEDBACK_VIDEO_REQUESTED",e.UPLOAD_FEEDBACK_VIDEO_STATUS="UPLOAD_FEEDBACK_VIDEO_STATUS",e.UPDATE_CAPTCHA_VISIBLE="UPDATE_CAPTCHA_VISIBLE",e.UPDATE_CAPTCHA_SIGNATURE="UPDATE_CAPTCHA_SIGNATURE",e.UPDATE_CAPTCHA_SIGNATURE_SUCCEEDED="UPDATE_CAPTCHA_SIGNATURE_SUCCEEDED",e.SET_TEXT_BOX_HEIGHT="SET_TEXT_BOX_HEIGHT",e.UPDATE_RELATED_CAPACITY="UPDATE_RELATED_CAPACITY",e.UPDATE_IS_MAIN_PAGE="UPDATE_IS_MAIN_PAGE",e.UPDATE_DEL_PERMISSION="UPDATE_DEL_PERMISSION",e.UPDATE_SHOW_AUTO_HANGUP_MODAL="UPDATE_SHOW_AUTO_HANGUP_MODAL",e.REPORT_USER_REQUESTED="REPORT_USER_REQUESTED",e.SET_CHAT_LIST_WIDTH="SET_CHAT_LIST_WIDTH",e.UPDATE_HAS_FETCHED_UNREAD="UPDATE_HAS_FETCHED_UNREAD",e.CHECK_USER_VERIFY_STATUS_REQUESTED="CHECK_USER_VERIFY_STATUS_REQUESTED",e.CHECK_USER_VERIFY_STATUS_SUCCEED="CHECK_USER_VERIFY_STATUS_SUCCEED"}(Xe||(Xe={}));var{getGuideRequested:ot,getGuideSucceeded:st,getGuideFailed:at}=(0,I.createActions)({[Xe.GET_GUIDE_REQUESTED]:({userId:e,version:t})=>({userId:e,version:t}),[Xe.GET_GUIDE_SUCCEEDED]:({newbie:e})=>({newbie:e}),[Xe.GET_GUIDE_FAILED]:()=>({})}),nt=1,ct="newbie-completed-info";function*it(t){var{payload:{userId:r,version:s}}=t;try{var a;if((yield(0,o.getItem)(ct))==="".concat(r,"-").concat(s))return[];a=[nt];var{newbie:n=[]}=yield(0,e.call)(U.fetch,{resource:"newbie",suffix:"uncompleted",params:{chat_types:"[".concat(a.join(","),"]")}});return yield(0,e.put)(st({newbie:n})),n.findIndex((e=>(e.name||"").toLocaleLowerCase().includes("mini")))<0&&(yield(0,o.setItem)(ct,"".concat(r,"-").concat(s))),n}catch(t){return yield(0,e.put)(at()),[]}}function*ut(){yield(0,e.takeEvery)(ot,it)}const Et={[Xe.GET_GUIDE_SUCCEEDED]:We(),[Xe.GET_GUIDE_FAILED]:e=>rt(rt({},e),{},{newbie:[]})};var{updateGuideRequested:lt,updateGuideSucceeded:St}=(0,I.createActions)({[Xe.UPDATE_GUIDE_REQUESTED]:({newbieId:e})=>({newbieId:e}),[Xe.UPDATE_GUIDE_SUCCEEDED]:({newbie:e})=>({newbie:e})});function*dt({payload:{newbieId:t}}){var r=function(e,t){var r=[...e];for(var o of r){var s=o.children.findIndex((e=>e.id===t));if(-1!==s){o.children.splice(s,1);break}}return r}(yield(0,e.select)(B),t);yield(0,e.put)(St({newbie:r}));try{yield(0,e.call)(U.fetch,{method:"PUT",resource:"newbie",id:t})}catch(e){}}function*_t(){yield(0,e.takeEvery)(lt,dt)}const pt={[Xe.UPDATE_GUIDE_SUCCEEDED]:We()};function Tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var{updateUserRequested:ht,updateNetworkStatus:Dt,fetchUserOrderDetailRequested:ft,fetchUserOrderDetailSucceeded:At,updateShowAutoHangupModal:yt,updateChatWindowStatus:gt,updateConversationDetailStatus:Ct,updateLoginSuccessStatus:Ut,updateChatEntryStatus:Pt,updateHasFetchedUnread:Rt}=(0,I.createActions)({[Xe.UPDATE_USER_REQUESTED]:({status:e})=>({status:e}),[Xe.UPDATE_NETWORK_STATUS]:({networkStatus:e})=>({networkStatus:e}),[Xe.FETCH_USER_ORDER_DETAIL_REQUESTED]:({userId:e,shopId:t})=>({userId:e,shopId:t}),[Xe.FETCH_USER_ORDER_DETAIL_SUCCEEDED]:({userId:e,shopId:t,data:r})=>({userId:e,shopId:t,data:r}),[Xe.UPDATE_SHOW_AUTO_HANGUP_MODAL]:({showAutoHangupModal:e})=>({showAutoHangupModal:e}),[Xe.UPDATE_CHAT_WINDOW_STATUS]:({showChatWindow:e})=>({showChatWindow:e}),[Xe.UPDATE_CONVERSATION_DETAIL_STATUS]:({showConversationDetail:e})=>({showConversationDetail:e}),[Xe.UPDATE_LOGIN_SUCCESS_STATUS]:({loginSuccess:e})=>({loginSuccess:e}),[Xe.UPDATE_CHAT_ENTRY_STATUS]:({showEntry:e})=>({showEntry:e}),[Xe.UPDATE_HAS_FETCHED_UNREAD]:({hasFetchedUnread:e})=>({hasFetchedUnread:e})});function*bt({payload:{status:t}}){try{yield(0,e.call)(U.fetch,{method:"PUT",resource:"user",payload:JSON.stringify({distribution_status:t})})}catch(t){yield(0,e.put)(po({error:t}))}}function*It({payload:{userId:t,shopId:r}}){try{var o=yield(0,e.call)(U.fetch,{parent:"users",parentId:t,resource:"get_user_shop_statistics_info",params:{shop_id:r}});yield(0,e.put)(At({userId:t,shopId:r,data:o}))}catch(e){}}function*vt(){yield(0,e.takeEvery)(ht,bt),yield(0,e.takeEvery)(ft,It)}const mt={[Xe.UPDATE_NETWORK_STATUS]:We(),[Xe.FETCH_USER_ORDER_DETAIL_SUCCEEDED]:(e,{payload:{userId:t,shopId:r,data:o}})=>{var s="".concat(t,"-").concat(r),a=e.shopStatisticsMap;return Ot(Ot({},e),{},{shopStatisticsMap:Ot(Ot({},a),{},{[s]:o})})},[Xe.UPDATE_SHOW_AUTO_HANGUP_MODAL]:We(),[Xe.UPDATE_CHAT_WINDOW_STATUS]:We(),[Xe.UPDATE_CONVERSATION_DETAIL_STATUS]:We(),[Xe.UPDATE_LOGIN_SUCCESS_STATUS]:We(),[Xe.UPDATE_CHAT_ENTRY_STATUS]:We(),[Xe.UPDATE_HAS_FETCHED_UNREAD]:We()};var Nt=r(672),wt=r(459),Ht=r(598),jt=r.n(Ht);function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var{loginRequested:Gt,loginSucceeded:kt,logoutRequested:Mt,logoutSucceeded:Vt,forceLogoutRequested:Qt}=(0,I.createActions)({[Xe.LOGIN_REQUESTED]:()=>({}),[Xe.LOGIN_SUCCEEDED]:({currentUserId:e,status:t})=>({currentUserId:e,status:t}),[Xe.LOGOUT_REQUESTED]:()=>({}),[Xe.LOGOUT_SUCCEEDED]:()=>({}),[Xe.FORCE_LOGOUT_REQUESTED]:()=>({})});function*qt(t){(yield(0,e.call)(o.getItem,t))||(yield(0,e.call)(o.setItem,t,(0,wt.v4)()))}function*xt(){var t=(0,o.getTranslationLocale)((0,o.getRuntimeLocale)()),r=yield(0,e.call)(U.getTranslation,{locale:t});yield(0,e.call)(o.changeLanguage,t,r)}var Wt=function*(t){var r,s,a=window.__CHATEASY_TRANSLATION__;if((0,o.checkEmptyObject)(a)||(0,o.checkEmptyObject)(a.collection)){var n=jt().get("language");if(n)s=o.localeInMallToTspLocale[n]||"en";else{var c=o.defaultLocalInMall[(0,o.getRuntimeRegion)()]||"en";s=o.localeInMallToTspLocale[c]||"en"}(0,U.collectAsyncTask)(U.ReportPoint.TRANSLATION_IN_SERVICE,0)}else{(0,U.collectAsyncTask)(U.ReportPoint.TRANSLATION_IN_HTML,0);var i={};Object.keys(a.collection).forEach((e=>{i=Object.assign(i,a.collection[e])})),r=i,s=window.__CHATEASY_LOCALE__}if(!r)try{r=yield(0,e.call)(U.getTranslation,{locale:s})}catch(t){r=yield(0,e.call)(U.getTranslation,{locale:(0,o.getTranslationLocale)((0,o.getRuntimeLocale)())})}yield(0,e.call)(o.changeLanguage,s,r),yield(0,e.call)(o.updateTimeLocale,(0,o.getServiceLocale)(s))},Bt=function*(t){var r;yield(0,e.call)(xt),yield(0,e.put)(Pt({showEntry:!0})),yield(0,e.put)(Ut({loginSuccess:!1})),(0,U.collectAsyncTask)(U.ReportPoint.LOGIN_FAILED,0,{type:(r=t,r instanceof U.InternalServerError?"InternalServerError":r instanceof U.Forbidden?"Forbidden":r instanceof U.Unauthoried?"Unauthoried":"Other")})};function*Kt(t,r){try{var{godToken:s}=r,{user:a}=t,{id:n,type:c,locale:i,distribution_status:u}=a,E=c===o.AccountType.SUBACCOUNT;window.__WEBCHAT_LOGIN__||E&&"working"===u&&(window.__WEBCHAT_LOGIN__=!0),yield(0,e.call)(Wt,i||"en"),performance.mark("APP_RENDERING"),(0,U.collectLoadTask)(),(0,U.mdapConfig)(c),(0,U.configTrackerUser)(a),yield(0,e.put)(Dt({networkStatus:"online"})),window.addEventListener("online",(()=>{Nt.store.dispatch(Dt({networkStatus:"online"}))})),window.addEventListener("offline",(()=>{Nt.store.dispatch(Dt({networkStatus:"offline"}))})),window.addEventListener("message",(e=>{var t;if("captcha-modal"===(null===(t=e.data)||void 0===t?void 0:t.type)){var r,s,a,n;if(3===(null===(r=e.data)||void 0===r?void 0:r.status)){var c,i,u;console.log("==== event.data",e);var E=null===(c=e.data)||void 0===c?void 0:c.AC_CERT_D;E&&(0,o.isVisitingCn)()&&jt().set("AC_CERT_D",E,{secure:!0,domain:"".concat(window.location.host),expires:new Date((new Date).getTime()+6e4)}),Nt.store.dispatch(ia()),null===(i=(u=window).closeSFUCaptchaModal)||void 0===i||i.call(u)}1===(null===(s=e.data)||void 0===s?void 0:s.status)&&(Nt.store.dispatch(na()),null===(a=(n=window).closeSFUCaptchaModal)||void 0===a||a.call(n))}}),!1),yield(0,e.put)(Ut({loginSuccess:!0})),yield(0,e.put)(Pt({showEntry:!0}));var{entities:l}=(0,U.normalize)("users",a);yield(0,e.put)(v({entities:l})),s||(yield(0,e.call)(Ve.startConnect)),yield(0,e.put)(kt({currentUserId:n})),yield(0,e.call)(sr),yield(0,e.spawn)(qt,"device_id"),E||(yield(0,e.call)(Ls,ms({shopId:a.shop_id})))}catch(t){yield(0,e.call)(Bt,t)}}function*Yt(){try{performance.mark("APP_PREPARED");var t={};if(window.__WEBCHAT_SESSION__)(0,U.collectAsyncTask)(U.ReportPoint.LOGIN_IN_HTML,0),t=window.__WEBCHAT_SESSION__;else{(0,U.collectAsyncTask)(U.ReportPoint.LOGIN_IN_SERVICE,0);var r={method:"POST",subServer:"coreapi",resource:"login"},s=(0,o.isVisitingCNSC)()||(0,o.isVisitingKRSC)();r.params={source:"pcmall"},s&&(r.parent="cbsc"),t=yield(0,e.call)(U.fetch,r)}return performance.mark("LOGIN_API_RESPONSED"),yield(0,o.setItem)("mini-session",t),o.LS.setItem("mini-session",JSON.stringify(t)),{session:t,params:{godToken:""}}}catch(t){yield(0,e.call)(Bt,t)}}function*zt(){yield(0,e.takeLatest)(Gt,Yt),yield(0,e.takeLatest)(Mt,Rr),yield(0,e.takeLatest)(Qt,Pr)}const Xt={[Xe.LOGIN_SUCCEEDED]:We(),[Xe.LOGOUT_SUCCEEDED]:e=>Ft(Ft({},e),{},{currentUserId:null,performance:{},closeHangupTips:!1,hasVideoPermission:!1,captchaVisible:!1,curTabFocused:!0})};function Jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Zt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var{checkUserPermissionSucceeded:$t,updateDelPermission:er,checkUserVerifyStatusRequested:tr,checkUserVerifyStatusSucceed:rr}=(0,I.createActions)({[Xe.CHECK_USER_PERMISSION_SUCCEEDED]:({hasVideoPermission:e,hasReplyPermission:t,hasDeletePermission:r,deleteConfigDuration:o,deleteConfigVersion:s,waitingTimeFilter:a,subaccountHasUnrepliedPermission:n,showCrrDue:c,hideFeedback:i})=>({hasVideoPermission:e,hasReplyPermission:t,hasDeletePermission:r,deleteConfigDuration:o,deleteConfigVersion:s,waitingTimeFilter:a,subaccountHasUnrepliedPermission:n,showCrrDue:c,hideFeedback:i}),[Xe.UPDATE_DEL_PERMISSION]:({hasDeletePermission:e,deleteConfigDuration:t,deleteConfigVersion:r})=>({hasDeletePermission:e,deleteConfigDuration:t,deleteConfigVersion:r}),[Xe.CHECK_USER_VERIFY_STATUS_REQUESTED]:()=>({}),[Xe.CHECK_USER_VERIFY_STATUS_SUCCEED]:({hasVerifyPhoneNumber:e,shopId:t,isSubAccount:r})=>({hasVerifyPhoneNumber:e,shopId:t,isSubAccount:r})}),or={hasVideoPermission:!1,hasReplyPermission:!1,hasDeletePermission:!1,deleteConfigDuration:0,deleteConfigVersion:0,waitingTimeFilter:!1,showCrrDue:!1,hideFeedback:!1};function*sr(){var t=yield(0,e.select)(ie),{type:r,country:o}=t;try{var s=yield(0,e.call)(U.fetch,{subServer:"coreapi",parent:"user",resource:"global_config"}),{video:a,reply:n,waiting_time_filter:c,show_crr_due:i,delete_msg:u,support_subaccount_unreplied:E,hide_feedback:l}=s||{},S=Zt(Zt({},or),{},{hasVideoPermission:a,hasReplyPermission:n,waitingTimeFilter:c,showCrrDue:i,hideFeedback:l});if(S.waitingTimeFilter=!1,"seller"===r){var{config_version:d,region_config:_=[]}=u||{};S.deleteConfigVersion=d;var p=_.find((e=>e.region===o));p&&p.duration&&(S.hasDeletePermission=!0,S.deleteConfigDuration=p.duration)}else S.subaccountHasUnrepliedPermission=E;yield(0,e.put)($t(Zt({},S)))}catch(t){yield(0,e.put)($t(Zt({},or)))}}function*ar(t){try{var r=yield(0,e.select)(Ee),o={need_fields:["phone_verified"]};r&&(o.shop_id=t);var s=yield(0,e.call)(U.fetch,{subServer:"coreapi",parent:"user",resource:"get_info",method:"POST",payload:JSON.stringify(o)});return yield(0,e.put)(rr({hasVerifyPhoneNumber:s.is_phone_verified,shopId:t,isSubAccount:r})),s.is_phone_verified}catch(e){}}const nr={[Xe.CHECK_USER_PERMISSION_SUCCEEDED]:We(),[Xe.UPDATE_DEL_PERMISSION]:We(),[Xe.CHECK_USER_VERIFY_STATUS_SUCCEED]:(e,{payload:{hasVerifyPhoneNumber:t,shopId:r,isSubAccount:o}})=>Zt(Zt({},e),{},o?{hasVerifyPhoneNumberMap:Zt(Zt({},e.hasVerifyPhoneNumberMap),{},{[r]:t})}:{hasVerifyPhoneNumber:t})};var{showUserRequested:cr}=(0,I.createActions)({[Xe.SHOW_USER_REQUESTED]:({userId:e,shopId:t,buyerShopId:r})=>({userId:e,shopId:t,buyerShopId:r})});function*ir({payload:{userId:t,shopId:r,buyerShopId:o}}){var s;try{s=yield(0,e.call)(U.fetch,{resource:"users",id:t,params:{shop_id:r,need_cache:1,cache_expires:1800}})}catch(e){s={id:t,shop_id:o}}var{entities:a}=(0,U.normalize)("users",s);yield(0,e.put)(v({entities:a})),yield(0,e.put)(ft({userId:t,shopId:r}))}function*ur(){yield(0,e.takeEvery)(cr,ir)}var{updateIsMainPage:Er,updateCurTabFocused:lr,updateCurTabFocusedSucceeded:Sr}=(0,I.createActions)({[Xe.UPDATE_IS_MAIN_PAGE]:({isMainPage:e})=>({isMainPage:e}),[Xe.UPDATE_CUR_TAB_FOCUSED]:({focused:e})=>({focused:e}),[Xe.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED]:({curTabFocused:e})=>({curTabFocused:e})});function*dr({payload:{focused:t}}){t&&(yield(0,e.call)(Ve.tabFocused),yield(0,e.put)(Er({isMainPage:!0}))),yield(0,e.put)(Sr({curTabFocused:t}))}function*_r(){yield(0,e.takeEvery)(lr,dr)}const pr={[Xe.UPDATE_IS_MAIN_PAGE]:We(),[Xe.UPDATE_CUR_TAB_FOCUSED_SUCCEEDED]:We()};var{updateCaptchaVisible:Tr,updateCaptchaSignature:Or,updateCaptchaSignatureSucceeded:hr}=(0,I.createActions)({[Xe.UPDATE_CAPTCHA_VISIBLE]:({captchaVisible:e,resendMessagePayload:t})=>({captchaVisible:e,resendMessagePayload:t}),[Xe.UPDATE_CAPTCHA_SIGNATURE]:({signature:e=""})=>({signature:e}),[Xe.UPDATE_CAPTCHA_SIGNATURE_SUCCEEDED]:({captchaSignature:e=""})=>({captchaSignature:e})});const Dr={[Xe.UPDATE_CAPTCHA_VISIBLE]:We(),[Xe.UPDATE_CAPTCHA_SIGNATURE_SUCCEEDED]:We()};function fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var{setTextBoxHeight:yr,setChatListWidth:gr}=(0,I.createActions)({[Xe.SET_TEXT_BOX_HEIGHT]:e=>e,[Xe.SET_CHAT_LIST_WIDTH]:e=>e});const Cr={[Xe.SET_TEXT_BOX_HEIGHT]:(e,t)=>{var{payload:r}=t;return Ar(Ar({},e),{},{textBoxHeight:r})},[Xe.SET_CHAT_LIST_WIDTH]:(e,t)=>{var{payload:r}=t;return Ar(Ar({},e),{},{chatlistWidth:r})}};var{blockUserRequested:Ur}=(0,I.createActions)({[Xe.BLOCK_USER_REQUESTED]:({buyerName:e,buyerId:t,block:r=!0,shopId:o,conversationId:s})=>({buyerName:e,buyerId:t,block:r,shopId:o,conversationId:s})}),Pr=function*(t=!0){t&&(yield(0,e.call)(Ve.closeConnect)),yield(0,e.put)(Vt()),yield(0,e.put)(ys()),(0,o.removeItem)("mini-session"),(0,o.removeItem)("mini-sc_redirect")},Rr=function*(){try{var t={server:(0,o.getSCApiServer)(),namespace:"",resource:"logout/",params:{SPC_CDS:jt().get("SPC_CDS"),SPC_CDS_VER:2}};(0,o.isVisitingCNSC)()||(0,o.isVisitingKRSC)()?(t.version="cnsc",t.parent="selleraccount"):t.version="v1",yield(0,e.call)(U.fetch,t),document.location.replace("https://".concat((0,o.getSellerCenterUrl)(),"/account/signin")),window.removeEventListener("online",(()=>{Nt.store.dispatch(Dt({networkStatus:"online"}))})),window.removeEventListener("offline",(()=>{Nt.store.dispatch(Dt({networkStatus:"offline"}))})),(0,U.clearApiCache)(),yield(0,e.call)(Pr)}catch(t){t.handler?(0,e.call)(t.handler):console.error("[Logout Failed] ",t)}},{reportUserRequested:br}=(0,I.createActions)({[Xe.REPORT_USER_REQUESTED]:({userId:e,shopId:t})=>({userId:e,shopId:t})});function Ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var mr,Nr=[ut,_t,vt,zt,ur,_r],wr={newbie:[],networkStatus:"online",hasVideoPermission:!1,currentUserId:null,currentUser:{},hasReplyPermission:!1,hasDeletePermission:!1,deleteConfigVersion:0,deleteConfigDuration:0,captchaVisible:!1,captchaSignature:"",resendMessagePayload:void 0,curTabFocused:!0,isMainPage:!0,shopStatisticsMap:{},subaccountHasUnrepliedPermission:!1,textBoxHeight:o.MINI_MIN_TEXT_BOX_HEIGHT,showAutoHangupModal:!1,waitingTimeFilter:!1,hasVerifyPhoneNumber:!1,hasVerifyPhoneNumberMap:{},showCrrDue:!1,loginSuccess:!0,showChatWindow:!1,showConversationDetail:!0,showEntry:!1,hasFetchedUnread:!1},Hr=(0,I.handleActions)(vr(vr(vr(vr(vr(vr(vr(vr({},nr),Dr),pr),Cr),Et),pt),mt),Xt),wr),jr=e=>(0,t.createSelector)(O,(t=>(0,q.denormalize)(e,U.shopSchema,{shops:t}))),Lr=e=>{var t;return(null==e||null===(t=e.shopReducer)||void 0===t?void 0:t.fetchedShopIds)||[]};!function(e){e.FETCH_SHOPS_REQUESTED="FETCH_SHOPS_REQUESTED",e.FETCH_SHOPS_SUCCEED="FETCH_SHOPS_SUCCEED",e.UPDATE_FETCH_SHOPS_STATUS="UPDATE_FETCH_SHOPS_STATUS",e.FETCH_SHOP_AUTH_REQUESTED="FETCH_SHOP_AUTH_REQUESTED",e.UPDATE_FETCHED_SHOP_IDS="UPDATE_FETCHED_SHOP_IDS",e.UPDATE_SHOP_FILTER="UPDATE_SHOP_FILTER",e.VISIT_SHOP_SELLER_CENTER_REQUESTED="VISIT_SHOP_SELLER_CENTER_REQUESTED",e.VISIT_MALL_REQUESTED="VISIT_MALL_REQUESTED",e.SEARCH_SHOPS_REQUESTED="SEARCH_SHOPS_REQUESTED",e.SEARCH_SHOPS_SUCCEED="SEARCH_SHOPS_SUCCEED",e.UPDATE_SEARCH_SHOPS_STATUS="UPDATE_SEARCH_SHOPS_STATUS",e.FETCH_SHOP_DETAIL_INFO="FETCH_SHOP_DETAIL_INFO",e.UPDATE_CURRENT_FETCH_SHOP_IDS="UPDATE_CURRENT_FETCH_SHOP_IDS",e.RESET_CURRENT_FETCH_SHOPS="RESET_CURRENT_FETCH_SHOPS"}(mr||(mr={}));var{fetchShopsRequested:Fr,fetchShopsSucceed:Gr,updateFetchShopsStatus:kr,fetchShopAuthRequested:Mr,updateFetchedShopIds:Vr,updateShopFilter:Qr,visitShopSellerCenterRequested:qr,searchShopsRequested:xr,searchShopsSucceed:Wr,updateSearchShopsStatus:Br,fetchShopDetailInfo:Kr}=(0,I.createActions)({[mr.FETCH_SHOPS_REQUESTED]:({region:e})=>({region:e}),[mr.FETCH_SHOPS_SUCCEED]:({pagination:e,result:t})=>({pagination:e,result:t}),[mr.UPDATE_FETCH_SHOPS_STATUS]:({status:e})=>({status:e}),[mr.FETCH_SHOP_AUTH_REQUESTED]:({shopId:e})=>({shopId:e}),[mr.UPDATE_FETCHED_SHOP_IDS]:({shopIds:e})=>({shopIds:e}),[mr.UPDATE_SHOP_FILTER]:({shopFilter:e})=>({shopFilter:e}),[mr.VISIT_SHOP_SELLER_CENTER_REQUESTED]:({url:e,shopId:t,orderId:r,itemId:o,returnId:s})=>({url:e,shopId:t,orderId:r,itemId:o,returnId:s}),[mr.SEARCH_SHOPS_REQUESTED]:({keyword:e,region:t})=>({keyword:e,region:t}),[mr.SEARCH_SHOPS_SUCCEED]:({pagination:e,result:t,keyword:r})=>({pagination:e,result:t,keyword:r}),[mr.UPDATE_SEARCH_SHOPS_STATUS]:({searchStatus:e})=>({searchStatus:e}),[mr.FETCH_SHOP_DETAIL_INFO]:({shopId:e})=>({shopId:e})});function*Yr({payload:{shopId:t}}){try{var r=yield(0,e.select)(jr(t));r=yield(0,e.call)(U.fetch,{resource:"shop",id:t,params:{need_cache:1,cache_expires:600}});var{entities:o}=(0,U.normalize)("shops",r);return yield(0,e.put)(v({entities:o})),yield(0,e.put)(Vr({shopIds:[r.id]})),r}catch(e){return{}}}const zr={[mr.UPDATE_SHOP_FILTER]:We()};function*Xr({payload:{url:t,shopId:r,orderId:s,itemId:a,returnId:n}}){try{var{sc_url:c,upgraded:i,region:u}=yield(0,e.call)(U.fetch,{resource:"shop",id:r,suffix:"sc"});if(i){var E=window.open();if(t){var l=t.split("/");l[2]=(0,o.getSellerCenterUrl)(u);var S=l.join("/");E.location=S.includes("?")?"".concat(S,"&cnsc_shop_id=").concat(r):"".concat(S,"?cnsc_shop_id=").concat(r)}else E.location=s?"https://".concat((0,o.getSellerCenterUrl)(u),"/portal/sale/").concat(s,"?cnsc_shop_id=").concat(r):a?"https://".concat((0,o.getSellerCenterUrl)(u),"/portal/product/").concat(a,"?cnsc_shop_id=").concat(r):n?"https://".concat((0,o.getSellerCenterUrl)(u),"/portal/sale/return/").concat(n,"?cnsc_shop_id=").concat(r):"https://".concat((0,o.getSellerCenterUrl)(u),"?cnsc_shop_id=").concat(r);return}if(c){var d=c.split("?"),_=d[1].split("&").find((e=>e.startsWith("sig="))).substring(4),p=d[0].split("."),T=p[p.length-1],O=window.open();if(t)return void(O.location=t.includes("?")?"".concat(t,"&sig=").concat(_):"".concat(t,"?sig=").concat(_));if(s||a||n){if(s){var h="https://".concat((0,o.getSellerCenterUrl)(T),"/portal/sale/").concat(s,"?sig=").concat(_);O.location=h}else if(a){var D="https://".concat((0,o.getSellerCenterUrl)(T),"/portal/product/").concat(a,"?sig=").concat(_);O.location=D}else if(n){var f="https://".concat((0,o.getSellerCenterUrl)(T),"/portal/sale/return/").concat(n,"?sig=").concat(_);O.location=f}}else{var A="https://".concat((0,o.getSellerCenterUrl)(T),"?sig=").concat(_);O.location=A}}else{var y=So(!1,{type:"permission-denied"});yield(0,e.put)(po({toast:y}))}}catch(t){var g=yield(0,e.select)(jr(r)),C="https://".concat((0,o.getSellerCenterUrl)(g.country),"/portal/"),P=s?"sale/".concat(s):a?"product/".concat(a):n?"sale/return/".concat(n):"";window.open(C+P)}}function Jr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Zr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jr(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $r=e=>new Promise((t=>{(0,U.fetch)({parent:"conversation",resource:"unread-counts",params:{shop_ids:JSON.stringify(e)}}).then((({"unread-counts":e=[]})=>{t(e)})).catch((()=>{t([])}))})),eo=({shopIds:e})=>{var t={ids:JSON.stringify(e)};return new Promise((e=>{(0,U.fetch)({resource:"shop_list",params:t}).then((({shops:t=[]})=>{e(t)})).catch((()=>{e([])}))}))};function*to({payload:{shopId:t}}){try{return yield(0,e.call)(U.fetch,{parent:"shop",parentId:t,resource:"auth"})}catch(e){return{}}}const ro={[mr.FETCH_SHOPS_SUCCEED]:Be("fetchResult"),[mr.SEARCH_SHOPS_SUCCEED]:Be("searchResult"),[mr.UPDATE_FETCH_SHOPS_STATUS]:We(),[mr.UPDATE_SEARCH_SHOPS_STATUS]:We(),[mr.UPDATE_FETCHED_SHOP_IDS]:(e,{payload:{shopIds:t}})=>{var r=e.fetchedShopIds;return Zr(Zr({},e),{},{fetchedShopIds:[...new Set(r.concat(t))]})}};function oo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function so(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oo(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ao,no={currentPage:0,perPage:20,hasMore:!0},co=[function*(){yield(0,e.takeEvery)(Kr,Yr)},function*(){yield(0,e.takeEvery)(Mr,to)},function*(){yield(0,e.takeEvery)(qr,Xr)}],io={shopFilter:null,fetchedShopIds:[],fetchResult:{pagination:so({},no),result:[]},status:"",searchResult:{pagination:so({},no),result:[],keyword:""},searchStatus:""},uo=(0,I.handleActions)(so(so({},zr),ro),io),Eo=e=>e.toastReducer.toast,lo=r(701).t,So=(e,t)=>{var r={};if(t){switch(t.type){case"auto-reply":e?t.first&&"enabled"===t.action?(r.message=lo("settings.enable_auto_reply_successfully"),r.show=!0):(r.message="",r.show=!1):(t.first&&"enabled"===t.action?r.message=lo("settings.failed_to_enable_auto_reply"):r.message="enabled"===t.action?lo("settings.failed_to_enable"):lo("settings.failed_to_disable"),r.show=!0);break;case"message":r.message=e?"save"===t.action?lo("settings.message.save_successfully"):"delete"===t.action?lo("settings.message.delete_successfully"):lo("settings.message.import_successfully"):"save"===t.action?lo("settings.message.failed_to_save"):"delete"===t.action?lo("settings.message.failed_to_delete"):lo("settings.message.failed_to_import"),r.show=!0;break;case"message-tips":e?(r.message="",r.show=!1):(r.message="enabled"===t.action?lo("settings.failed_to_enable"):lo("settings.failed_to_disable"),r.show=!0);break;case"forward":e||(r.message=403===t.status?lo("forward.exception",{forwardName:""}):lo("forward.server_error"),r.show=!0);break;case"send-feedback":r.message=lo("feedback_modal.error.failed_to_send"),r.show=!0;break;case"server-error-tips":r.message=lo("common.server_error.warning_tips"),r.show=!0;break;case"conversation-closed-tip":r.message=lo("conversation_detail.closed.warning_tips"),r.show=!0;break;case"permission-denied":r.message=lo("common.permission_denied"),r.show=!0;break;case"claim-voucher":r.message=lo(e?"voucher.claim.success":"voucher.claim.fail"),r.show=!0;break;case"claim-voucher-not-satisfy":r.message=lo("voucher.claim.fail_not_satisfy_rule"),r.show=!0;break;case"claim-voucher-already-claimed":r.message=lo("voucher.claim.fail_already_claimed"),r.show=!0;break;case"private-image":r.message=lo("common.image.expired"),r.show=!0;break;case"operation":"save"===t.action&&(r.message=lo(e?"text.save_successfully":"text.save_failed")),r.show=!0;break;default:r.message=t.message,r.show=!0}r.type=e?"success":"fail"}return r};!function(e){e.COPY_SUCCEED_FEEDBACK="COPY_SUCCEED_FEEDBACK",e.SET_TOAST_INFORMATION="SET_TOAST_INFORMATION",e.SET_TOAST_INFORMATION_SUCCEEDED="SET_TOAST_INFORMATION_SUCCEEDED"}(ao||(ao={}));var{copySucceedFeedback:_o,setToastInformation:po,setToastInformationSucceeded:To}=(0,I.createActions)({[ao.COPY_SUCCEED_FEEDBACK]:()=>({}),[ao.SET_TOAST_INFORMATION]:({type:e,error:t,toast:r})=>({type:e,error:t,toast:r}),[ao.SET_TOAST_INFORMATION_SUCCEEDED]:({toast:e})=>({toast:e})});function*Oo({payload:{type:t,error:r,toast:o}}){if(yield(0,e.select)(Ae)){var s=null;t&&(s=So(!1,{type:t})),void 0!==r&&(s=r instanceof U.CustomError||r instanceof U.Webview?r.handler():So(!1,{type:"server-error-tips"})),o&&(s=o),yield(0,e.put)(To({toast:s}))}}const ho={[ao.SET_TOAST_INFORMATION_SUCCEEDED]:We()};var Do=r(701).t;function*fo(){yield(0,e.put)(po({toast:So(!0,{message:Do("common.successful_copied")})}))}function Ao(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var yo,go=[function*(){yield(0,e.takeEvery)(po,Oo)},function*(){yield(0,e.takeEvery)(_o,fo)}],Co=(0,I.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ao(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ao(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},ho),{toast:{type:"",message:"",show:!1}}),Uo=e=>e.messageShortcutGroupReducer||{groups:[],status:"",currentGroupType:-1,currentGroupId:-1},Po=(0,t.createSelector)(Uo,(e=>e.status)),Ro=(0,t.createSelector)(Uo,(e=>e.currentGroupType)),bo=(0,t.createSelector)(Uo,(e=>e.currentGroupId)),Io=(0,t.createSelector)(Uo,(e=>e.groups)),vo=(0,t.createSelector)(Io,(e=>e.filter((e=>e.group_type===o.MessageShortcutGroupType.PERSONAL)))),mo=(0,t.createSelector)(Io,(e=>e.filter((e=>e.group_type===o.MessageShortcutGroupType.TEAM)))),No=(0,t.createSelector)(Io,Ro,((e,t)=>-1===t?e:e.filter((e=>e.group_type===t)))),wo=(0,t.createSelector)(vo,(e=>e.reduce(((e,t)=>{var{message_shortcuts:r=[]}=t;return e.concat(r)}),[]))),Ho=(0,t.createSelector)(mo,(e=>e.reduce(((e,t)=>{var{message_shortcuts:r=[]}=t;return e.concat(r)}),[]))),jo=(0,t.createSelector)(wo,Ho,((e=[],t=[])=>[...e,...t])),Lo=(0,t.createSelector)(jo,(e=>[...e.filter((e=>!(null==e||!e.pin_time))).sort(((e,t)=>e.pin_time-t.pin_time)),...e.filter((e=>!(null!=e&&e.pin_time)))])),Fo=(0,t.createSelector)(Lo,Ro,bo,((e,t,r)=>{var o=-1===t?e:e.filter((e=>e.group_type===t));return-1===r?o:o.filter((e=>e.groupId===r))})),Go=e=>e.settingsReducer.settings,ko=e=>e.settingsReducer.needForceUpdate,Mo=e=>e.settingsReducer.status,Vo=e=>e.settingsReducer.fetchStatus,Qo=(0,t.createSelector)(Go,(e=>e.auto_translation_status||"")),qo=(0,t.createSelector)(Go,(e=>e.message_shortcuts_status||"")),xo=(0,t.createSelector)(Go,(e=>e.legacy_message_shortcuts_count||0)),Wo=(0,t.createSelector)(Go,(e=>e.distribution_account_status||"enabled")),Bo=(0,t.createSelector)(Go,(e=>e.display_banner||!1));!function(e){e.FETCH_SETTINGS_REQUESTED="FETCH_SETTINGS_REQUESTED",e.FETCH_SETTINGS_SUCCEEDED="FETCH_SETTINGS_SUCCEEDED",e.FETCH_SETTINGS_STATUS="FETCH_SETTINGS_STATUS",e.UPDATE_SETTING_STATUS="UPDATE_SETTING_STATUS",e.UPDATE_SETTINGS_REQUESTED_BY_TYPE="UPDATE_SETTINGS_REQUESTED_BY_TYPE",e.UPDATE_SETTINGS_REQUESTED="UPDATE_SETTINGS_REQUESTED",e.UPDATE_SETTINGS_SUCCEEDED="UPDATE_SETTINGS_SUCCEEDED"}(yo||(yo={}));var{fetchSettingsSucceeded:Ko,fetchSettingsStatus:Yo,updateSettingStatus:zo,updateSettingsRequestedByType:Xo,updateSettingsRequested:Jo,updateSettingsSucceeded:Zo}=(0,I.createActions)({[yo.FETCH_SETTINGS_SUCCEEDED]:({settings:e,fetchStatus:t,timestamp:r,needForceUpdate:o})=>({settings:e,fetchStatus:t,timestamp:r,needForceUpdate:o}),[yo.FETCH_SETTINGS_STATUS]:({fetchStatus:e})=>({fetchStatus:e}),[yo.UPDATE_SETTING_STATUS]:({status:e})=>({status:e}),[yo.UPDATE_SETTINGS_REQUESTED_BY_TYPE]:e=>e,[yo.UPDATE_SETTINGS_REQUESTED]:({params:e})=>({params:e}),[yo.UPDATE_SETTINGS_SUCCEEDED]:({settings:e,needForceUpdate:t})=>({settings:e,needForceUpdate:t})});function*$o(){try{yield(0,e.put)(Yo({fetchStatus:o.DataFetchStatus.PENDING}));var t=yield(0,e.call)(U.fetch,{parent:"user",resource:"setting"});return yield(0,e.put)(Ko({settings:t,fetchStatus:o.DataFetchStatus.SUCCEED,timestamp:Date.now(),needForceUpdate:!1})),t}catch(t){return yield(0,e.put)(Yo({fetchStatus:o.DataFetchStatus.FAILED})),{}}}const es={[yo.FETCH_SETTINGS_SUCCEEDED]:We(),[yo.FETCH_SETTINGS_STATUS]:We()};function ts(e,t){if(null==e)return{};var r,o,s=function(e,t){if(null==e)return{};var r,o,s={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var rs=["extra","linked"];function os(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ss(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?os(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):os(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function*as({payload:{params:t}}){var{extra:r,linked:s}=t,a=ts(t,rs);try{yield(0,e.put)(Bs({event_time:(0,o.getCurrentTimestampString)(),url:window.location.href})),yield(0,e.put)(zo({status:o.OperationStatus.PENDING}));var n=yield(0,e.call)(U.fetch,{method:"PUT",parent:"user",resource:"setting",payload:JSON.stringify(ss({},a))});yield(0,e.put)(Zo({settings:n,needForceUpdate:!0}));var c=So(!0,r);yield(0,e.put)(po({toast:c})),yield(0,e.put)(zo({status:o.OperationStatus.SUCCEED})),s||(yield(0,e.call)(Ve.shareSettingData,ss(ss({type:o.ShareDataType.UPDATE_SETTING},t),{},{linked:!0,settings:n,needForceUpdate:!0})))}catch(t){var i,u=t instanceof U.Blacklist,E=t instanceof U.InternalServerError,l=u?o.OperationStatus.BLACKLIST_ERROR:E?o.OperationStatus.INTERNAL_SERVER_ERROR:o.OperationStatus.FAILED;yield(0,e.put)(zo({status:l})),E?yield(0,e.put)(po({error:t})):u||(i=So(!1,r),yield(0,e.put)(po({toast:i})))}}const ns={[yo.UPDATE_SETTINGS_SUCCEEDED]:We()},cs={[yo.UPDATE_SETTING_STATUS]:We()};function is(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function us(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?is(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):is(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Es,ls=[function*(){yield(0,e.takeLatest)([Jo],as)}],Ss=(0,I.handleActions)(us(us(us({},es),ns),cs),{settings:{},fetchStatus:"",status:""});!function(e){e.HANDLE_401_ERROR_REQUESTED="HANDLE_401_ERROR_REQUESTED",e.UPDATE_CONVERSATION_LISTS_HASH="UPDATE_CONVERSATION_LISTS_HASH",e.OPEN_MALL_URL="OPEN_MALL_URL"}(Es||(Es={}));var{openMallUrl:ds}=(0,I.createActions)({[Es.OPEN_MALL_URL]:({path:e,region:t})=>({path:e,region:t})}),_s="xiapibuy.com";function*ps({payload:{path:t="",region:r=""}}){var s,a=r?r.toLowerCase():(0,o.getRuntimeRegion)();"cn"!==a&&"kr"!==a||(a="my");var n=t?t.startsWith("/")?t:"/".concat(t):"";if((0,o.isVisitingCn)())try{var{data:c}=yield(0,e.call)(U.fetch,{url:"https://".concat((0,o.getSCApiServer)(),"/selleraccount/nonce/get/")}),i="".concat((0,o.cnDomainHash)(a),".").concat((0,o.envPrefix)()).concat(_s),u=encodeURIComponent(window.btoa('{"next":"https://'.concat(i).concat(n,'"}')));n="/api/seller_platform/nonce/callback/?nonce=".concat(c.nonce,"&region=").concat(a,"&state=").concat(u),s="https://".concat(i).concat(n)}catch(e){s="https://".concat((0,o.cnDomainHash)(a),".").concat((0,o.envPrefix)()).concat(_s).concat(n)}else s="https://".concat((0,o.domainPrefix)(),".").concat((0,o.domainSuffix)(a)).concat(n);window.open(s)}var{handle401ErrorRequested:Ts}=(0,I.createActions)({[Es.HANDLE_401_ERROR_REQUESTED]:({resource:e})=>({resource:e})}),{updateConversationListsHash:Os}=(0,I.createActions)({[Es.UPDATE_CONVERSATION_LISTS_HASH]:()=>({})}),hs=[function*(){yield(0,e.takeEvery)(ds,ps)}],Ds=(0,t.createSelector)(a,(e=>e.offers||{})),fs=(e,r,s,a)=>(0,t.createSelector)(Ds,(t=>Object.values(t).filter((t=>t.product_id===a&&t.model_id===r&&t.conversation_id===e&&t.id!==s&&t.status===o.OfferStatus.PENDING)))),As=e=>(0,t.createSelector)(a,(t=>(0,q.denormalize)(e,U.offerSchema,t))),{reduxReset:ys}=(0,I.createActions)({REDUX_RESET:()=>({})});window.addExternalGlobal("resetAction",ys);var gs,Cs=e=>{var t;return(null===(t=e.draftReducer)||void 0===t?void 0:t.draftHash)||{}},Us=e=>(0,t.createSelector)(Cs,(t=>t[e]||"")),Ps=e=>e.translatePreferenceReducer.translationSettings,Rs=e=>e.translatePreferenceReducer.fetchSettingsStatus,bs=e=>e.translatePreferenceReducer.updateStatus;function Is(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function vs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Is(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Is(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.FETCH_SHOP_TRANSLATION_SETTINGS="FETCH_SHOP_TRANSLATION_SETTINGS",e.UPDATE_SHOP_TRANSLATION_SETTINGS="UPDATE_SHOP_TRANSLATION_SETTINGS",e.UPDATE_FETCH_STATUS="UPDATE_FETCH_STATUS",e.UPDATE_SETTING_PREFERENCE_STATUS="UPDATE_SETTING_PREFERENCE_STATUS",e.UPDATE_SHOP_TRANSLATION_SETTINGS_RECORD="UPDATE_SHOP_TRANSLATION_SETTINGS_RECORD"}(gs||(gs={}));var{fetchShopTranslationSettings:ms,updateShopTranslationSettings:Ns,updateFetchStatus:ws,updateSettingPreferenceStatus:Hs,updateShopTranslationSettingsRecord:js}=(0,I.createActions)({[gs.FETCH_SHOP_TRANSLATION_SETTINGS]:({shopId:e})=>({shopId:e}),[gs.UPDATE_SHOP_TRANSLATION_SETTINGS]:({settings:e})=>({settings:e}),[gs.UPDATE_FETCH_STATUS]:({fetchSettingsStatus:e})=>({fetchSettingsStatus:e}),[gs.UPDATE_SETTING_PREFERENCE_STATUS]:({updateStatus:e})=>({updateStatus:e}),[gs.UPDATE_SHOP_TRANSLATION_SETTINGS_RECORD]:({shopId:e,source:t,translationPreference:r,autoTranslationStatus:o,inTranslationFeedbackWhitelist:s})=>({shopId:e,source:t,translationPreference:r,autoTranslationStatus:o,inTranslationFeedbackWhitelist:s})});function*Ls({payload:{shopId:t}}){try{yield(0,e.put)(ws({fetchSettingsStatus:"loading"}));var{source:r,translation_preference:o,auto_translation_status:s,in_translation_feedback_whitelist:a}=yield(0,e.call)(U.fetch,{subServer:"workbenchapi",parent:"shop",resource:"setting",params:{shop_id:t}});yield(0,e.put)(ws({fetchSettingsStatus:"succeed"})),yield(0,e.put)(js({shopId:t,source:r,translationPreference:o,autoTranslationStatus:s,inTranslationFeedbackWhitelist:a}))}catch(t){yield(0,e.put)(ws({fetchSettingsStatus:"failed"}))}}function*Fs(){yield(0,e.takeEvery)(ms,Ls)}var Gs=(0,I.handleActions)({[gs.UPDATE_SHOP_TRANSLATION_SETTINGS_RECORD]:(e,{payload:{shopId:t,source:r,translationPreference:o,autoTranslationStatus:s,inTranslationFeedbackWhitelist:a}})=>{var n=vs({},e.translationSettings),c=n[t]||{};return n[t]=vs(vs({},c),{},{translationPreference:o,autoTranslationStatus:s}),r&&(n[t].source=r),a&&(n[t].inTranslationFeedbackWhitelist=a),vs(vs({},e),{},{translationSettings:n})},[gs.UPDATE_FETCH_STATUS]:We(),[gs.UPDATE_SETTING_PREFERENCE_STATUS]:We()},{translationSettings:{},fetchSettingsStatus:"",updateStatus:""}),ks=[Fs];function Ms(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Vs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ms(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ms(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function*Qs(t,r,o,s=[]){var a=t,n=[],c=[];Array.isArray(t)&&(a=((0,U.normalize)(o,t).entities||{})[o]||{}),r.forEach((t=>{var r=t.id,i=a[r];i?["conversations","agentConversations"].includes(o)&&(void 0!==i.faking||i.latestMessageStatus||void 0!==i.unreplied)?(delete(t=Vs(Vs({},i),t)).faking,delete t.latestMessageStatus,delete t.unreplied,c.push(t)):(s.length&&s.forEach((e=>{t[e]=i[e]})),n.push((0,e.put)(m({name:o,id:r,record:Vs({},t)})))):c.push(t)})),c.length&&n.push((0,e.put)(v({entities:(0,U.normalize)(o,c).entities}))),yield(0,e.all)(n)}var qs,xs=e=>(0,t.createSelector)(S,(t=>(0,q.denormalize)(e,[U.productSchema],{products:t}))),Ws=e=>e.reportReducer.beingReported;!function(e){e.REPORT_REQUESTED="REPORT_REQUESTED",e.CLEAR_REPORT_REQUESTED="CLEAR_REPORT_REQUESTED"}(qs||(qs={}));var{reportRequested:Bs,clearReportRequested:Ks}=(0,I.createActions)({[qs.REPORT_REQUESTED]:({event_time:e,url:t})=>({event_time:e,url:t}),[qs.CLEAR_REPORT_REQUESTED]:()=>({})});function Ys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function zs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ys(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function*Xs(){var t=yield(0,e.select)(Ws);if(t.length){var r=[...t];yield(0,e.put)(Ks()),r.sort(((e,t)=>Number(t.event_time)-Number(e.event_time))),yield(0,e.call)(U.fetch,{method:"POST",subServer:"coreapi",parent:"user",resource:"report_active",payload:JSON.stringify(zs(zs({},r[0]),{},{platform_id:(0,o.isVisitingCNSC)()||(0,o.isVisitingKRSC)()?2:1}))})}}const Js={[qs.REPORT_REQUESTED]:(e,{payload:{event_time:t,url:r}})=>({beingReported:[...e.beingReported,{event_time:t,url:r}]}),[qs.CLEAR_REPORT_REQUESTED]:e=>({beingReported:[]})};function Zs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var $s,ea=[function*(){for(;;)yield(0,e.delay)(6e4),yield Xs()}],ta=(0,I.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zs(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zs(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Js),{beingReported:[]});function ra(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function oa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ra(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ra(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.ADD_NEED_CAPTCHA_REQUEST="ADD_NEED_CAPTCHA_REQUEST",e.DELETE_CAPTCHA_REQUEST="DELETE_CAPTCHA_REQUEST",e.CLEAR_NEED_CAPTCHA_REQUEST="CLEAR_NEED_CAPTCHA_REQUEST",e.RESEND_NEED_CAPTCHA_REQUEST="RESEND_NEED_CAPTCHA_REQUEST"}($s||($s={}));const sa={[$s.ADD_NEED_CAPTCHA_REQUEST]:(e,{payload:{request:t}})=>{var r=[...e.verifyRequests];return r.push(t),oa(oa({},e),{},{verifyRequests:r})},[$s.DELETE_CAPTCHA_REQUEST]:e=>{var t=[...e.verifyRequests];return t.pop(),oa(oa({},e),{},{verifyRequests:t})},[$s.CLEAR_NEED_CAPTCHA_REQUEST]:e=>oa(oa({},e),{},{verifyRequests:[]})};var{addNeedCaptchaRequest:aa,deleteCaptchaRequest:na,clearNeedCaptchaRequest:ca,resendNeedCaptchaRequest:ia}=(0,I.createActions)({[$s.ADD_NEED_CAPTCHA_REQUEST]:({request:e})=>({request:e}),[$s.DELETE_CAPTCHA_REQUEST]:()=>({}),[$s.CLEAR_NEED_CAPTCHA_REQUEST]:()=>({}),[$s.RESEND_NEED_CAPTCHA_REQUEST]:()=>({})});function*ua(){try{var t=yield(0,e.select)(da);if(t.length)for(var r of(yield(0,e.put)(ca()),t)){var{id:o,extra:s}=r;switch(o){case"unread-count":yield(0,e.spawn)(Ve.doRefreshTotalUnreadConversationsCount,s);break;case"unread-count-single":yield(0,e.spawn)(doRefreshSingleShopUnreadConversationCount,s);break;case"send-message":yield(0,e.put)((0,Ve.resendMessageRequested)(s))}}}catch(e){}}function Ea(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var la=(0,I.handleActions)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ea(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ea(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},sa),{verifyRequests:[]}),Sa=[function*(){yield(0,e.takeEvery)(ia,ua)}],da=e=>e.captchaVerifyReducer.verifyRequests;function*_a(t,r,o){yield(0,e.takeEvery)(t,(function*(t){var s=t.payload.id;s?yield(0,e.race)({task:(0,e.call)(r,t),cancel:(0,e.take)((e=>e.type===o.toString()&&e.payload.id===s))}):yield(0,e.call)(r,t)}))}})(),_})())},53402:function(e,t,r){"use strict";e.exports=r(25061)}}]);